'use strict';

<<<<<<< HEAD
Object.defineProperty(exports, "__esModule", {
=======
Object.defineProperty(exports, '__esModule', {
>>>>>>> master
  value: true
});
exports.run = run;

var _chalk;

function _load_chalk() {
<<<<<<< HEAD
  return _chalk = _interopRequireDefault(require('chalk'));
=======
  return (_chalk = _interopRequireDefault(require('chalk')));
>>>>>>> master
}

var _os;

function _load_os() {
<<<<<<< HEAD
  return _os = _interopRequireDefault(require('os'));
=======
  return (_os = _interopRequireDefault(require('os')));
>>>>>>> master
}

var _path;

function _load_path() {
<<<<<<< HEAD
  return _path = _interopRequireDefault(require('path'));
=======
  return (_path = _interopRequireDefault(require('path')));
>>>>>>> master
}

var _yargs;

function _load_yargs() {
<<<<<<< HEAD
  return _yargs = _interopRequireDefault(require('yargs'));
=======
  return (_yargs = _interopRequireDefault(require('yargs')));
>>>>>>> master
}

var _jestUtil;

function _load_jestUtil() {
<<<<<<< HEAD
  return _jestUtil = require('jest-util');
=======
  return (_jestUtil = require('jest-util'));
>>>>>>> master
}

var _jestValidate;

function _load_jestValidate() {
<<<<<<< HEAD
  return _jestValidate = require('jest-validate');
=======
  return (_jestValidate = require('jest-validate'));
>>>>>>> master
}

var _jestConfig;

function _load_jestConfig() {
<<<<<<< HEAD
  return _jestConfig = require('jest-config');
=======
  return (_jestConfig = require('jest-config'));
>>>>>>> master
}

var _;

function _load_() {
<<<<<<< HEAD
  return _ = _interopRequireDefault(require('../'));
=======
  return (_ = _interopRequireDefault(require('../')));
>>>>>>> master
}

var _args;

function _load_args() {
<<<<<<< HEAD
  return _args = _interopRequireWildcard(require('./args'));
}

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

// eslint-disable-next-line import/default
const VERSION = require('../../package.json').version; /**
                                                        * Copyright (c) 2014-present, Facebook, Inc. All rights reserved.
                                                        *
                                                        * This source code is licensed under the MIT license found in the
                                                        * LICENSE file in the root directory of this source tree.
                                                        *
                                                        * 
                                                        */
=======
  return (_args = _interopRequireWildcard(require('./args')));
}

function _interopRequireWildcard(obj) {
  if (obj && obj.__esModule) {
    return obj;
  } else {
    var newObj = {};
    if (obj != null) {
      for (var key in obj) {
        if (Object.prototype.hasOwnProperty.call(obj, key))
          newObj[key] = obj[key];
      }
    }
    newObj.default = obj;
    return newObj;
  }
}

function _interopRequireDefault(obj) {
  return obj && obj.__esModule ? obj : {default: obj};
}

// eslint-disable-next-line import/default
const VERSION = require('../../package.json').version;
/**
 * Copyright (c) 2014-present, Facebook, Inc. All rights reserved.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 *
 *
 */
>>>>>>> master

function run(cliArgv, cliInfo) {
  const realFs = require('fs');
  const fs = require('graceful-fs');
  fs.gracefulify(realFs);

  let argv;
  if (cliArgv) {
    argv = cliArgv;
  } else {
<<<<<<< HEAD
    argv = (_yargs || _load_yargs()).default.usage((_args || _load_args()).usage).help(false).version(false).options((_args || _load_args()).options).argv;

    (0, (_jestValidate || _load_jestValidate()).validateCLIOptions)(argv, (_args || _load_args()).options);
=======
    argv = (_yargs || _load_yargs()).default
      .usage((_args || _load_args()).usage)
      .help(false)
      .version(false)
      .options((_args || _load_args()).options).argv;

    (0, (_jestValidate || _load_jestValidate()).validateCLIOptions)(
      argv,
      Object.assign({}, (_args || _load_args()).options, {
        deprecationEntries: (_jestConfig || _load_jestConfig())
          .deprecationEntries
      })
    );
>>>>>>> master
  }

  if (argv.help) {
    (_yargs || _load_yargs()).default.showHelp();
<<<<<<< HEAD
    process.on('exit', () => process.exitCode = 1);
=======
    process.on('exit', () => (process.exitCode = 1));
>>>>>>> master
    return;
  }

  if (argv.version) {
    console.log(`v${VERSION}\n`);
    return;
  }

  if (!argv._.length) {
    console.log('Please provide a path to a script. (See --help for details)');
<<<<<<< HEAD
    process.on('exit', () => process.exitCode = 1);
=======
    process.on('exit', () => (process.exitCode = 1));
>>>>>>> master
    return;
  }

  const root = process.cwd();
  const filePath = (_path || _load_path()).default.resolve(root, argv._[0]);

  if (argv.debug) {
    const info = cliInfo ? ', ' + cliInfo.join(', ') : '';
    console.log(`Using Jest Runtime v${VERSION}${info}`);
  }
<<<<<<< HEAD
  const options = (0, (_jestConfig || _load_jestConfig()).readConfig)(argv, root);
=======
  const options = (0, (_jestConfig || _load_jestConfig()).readConfig)(
    argv,
    root
  );
>>>>>>> master
  const globalConfig = options.globalConfig;
  // Always disable automocking in scripts.
  const config = Object.assign({}, options.projectConfig, {
    automock: false,
    unmockedModulePathPatterns: null
  });
<<<<<<< HEAD
  (_ || _load_()).default.createContext(config, {
    maxWorkers: (_os || _load_os()).default.cpus().length - 1,
    watchman: globalConfig.watchman
  }).then(hasteMap => {
    /* $FlowFixMe */
    const Environment = require(config.testEnvironment);
    const environment = new Environment(config);
    (0, (_jestUtil || _load_jestUtil()).setGlobal)(environment.global, 'console', new (_jestUtil || _load_jestUtil()).Console(process.stdout, process.stderr));
    environment.global.jestProjectConfig = config;
    environment.global.jestGlobalConfig = globalConfig;

    const runtime = new (_ || _load_()).default(config, environment, hasteMap.resolver);
    runtime.requireModule(filePath);
  }).catch(e => {
    console.error((_chalk || _load_chalk()).default.red(e.stack || e));
    process.on('exit', () => process.exitCode = 1);
  });
}
=======
  (_ || _load_()).default
    .createContext(config, {
      maxWorkers: (_os || _load_os()).default.cpus().length - 1,
      watchman: globalConfig.watchman
    })
    .then(hasteMap => {
      /* $FlowFixMe */
      const Environment = require(config.testEnvironment);
      const environment = new Environment(config);
      (0, (_jestUtil || _load_jestUtil()).setGlobal)(
        environment.global,
        'console',
        new (_jestUtil || _load_jestUtil()).Console(
          process.stdout,
          process.stderr
        )
      );
      environment.global.jestProjectConfig = config;
      environment.global.jestGlobalConfig = globalConfig;

      const runtime = new (_ || _load_()).default(
        config,
        environment,
        hasteMap.resolver
      );
      runtime.requireModule(filePath);
    })
    .catch(e => {
      console.error((_chalk || _load_chalk()).default.red(e.stack || e));
      process.on('exit', () => (process.exitCode = 1));
    });
}
>>>>>>> master
